---
title: "STAT 850 Report"
author: "Paulus Hermanto, Andrew Ker, Bipin Poudel"
date: "2022-11-18"
output: html_document
editor_options: 
  chunk_output_type: console
---

# Introduction
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# load in the data
footballgames <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-02-04/games.csv')
```


# Data
The data was originally gathered by Pro Football Reference. The data was stored in NFL Scores Main Page under All Game
Scores, which is linked here. [data](https://www.pro-football-reference.com/boxscores/game-scores.htm). The data was
used for a tidytuesday project in 2020
([data](https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-02-04/readme.md#gamescsv)) that 
primarily focused on NFL attendance. The data used for this report was found using the tidytuesday link.

This data originally contained 19 variables related to NFL game scores and outcomes. Out of these 19 variables, 11 were
character variables, seven were numeric variables, and one was a time variable. In order to meet project specifications
, a categorical variable was needed. To derive a categorical variable, a loop was utilized to replace values of "NA"
with a string "0" in the tie column and replace team names with a string "1". This also helped to clean the data, since
it does not make sense to list a team winner for a game that ended with a tie. After this loop, the strings of "0" and
"1" were converted to a categorical variable. This process essentially created a categorical variable with a value of 0
if an NFL game ended with one team winning and a value of 1 if an NFL game ended in a tie. The code for deriving this 
variable is shown below.

```{r, echo = TRUE, results = 'hide'}
##### derive categorical variable #####
# replace NA's in tie column with string 0
footballgames$tie[is.na(footballgames$tie)] <- "0"
# replace ties with string 1 instead of string with team name
for(i in 1:5324){
  if(footballgames$tie[i] != "0"){
    footballgames$tie[i] <- "1"
    i < i+1
  }
  else{
    i <- i+1
  }
}

# treat tie as categorical
footballgames$tie <- as.factor(footballgames$tie)


# get structure to check if tie is not a factor
str(footballgames)
```

After deriving the categorical variable, the data still had 19 variables, but with 10 character variables, seven
numeric variables, one time variable, and one categorical variable. For more information about the data, please refer
to the table below, which contains a list of variables, their descriptions, and their types.

Variable Name | Variable Description | Variable Type
------------- | -------------------- | -------------
year |
week |
home_team |
away_team |
winner |
tie |
day |
date |
time |
pts_win |
pts_loss |
yds_win |
turnovers_win |
yds_loss |
turnovers_loss |
home_team_name |
home_team_city |
away_team_name |
away_team_city |


#Interactive line plots for the number of wins for selected teams. 
```{r}
library(tidyverse)
library(magrittr)
library(dplyr)
library(ggplot2)
library(plotly)

a=footballgames %>% group_by(year) %>%  count(winner)
b = subset(a, winner== "Baltimore Ravens"|winner=="Chicago Bears"|winner=="Denver Broncos"|winner=="Miami Dolphins"|winner=="New England Patriots")

plot1<- ggplot(data= b, aes(year, n))+geom_line(aes(color=winner))+ xlab("Year")+ylab("Number of wins")+ggtitle("Number of games won by selected teams each year")

ggplotly(plot1)

```
